<!DOCTYPE html>
<html>
<style>
</style>
<head>
<meta charset="UTF-8">
<title>LED Controler - Controler</title>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous"></head>
<body onload="lade_Modus()">
<form id="Form" action="/Set_Values">
<!-- <form action="/action_page.php">  -->
  <select onchange="lade_Params()"id="Modus" name="Modus">
  </select>
  <p id="Inputs">
     Fehler
  </p>
  <input type="submit">
</form>
<script>
var Modus = document.getElementById("Modus");
var Inputs = document.getElementById("Inputs");

var xmthlModiDummy = '{"Modus":"Weiss","Liste":[{"Modus":"Aus"},{"Modus":"Weiss"},{"Modus":"Farbe"},{"Modus":"Verlauf"}]}';
var ModiListe;
var xhttpModi = new XMLHttpRequest();
  xhttpModi.onreadystatechange = function() {
    if (this.readyState == 4) {
		if( this.status == 404) { 
			ModiListe = JSON.parse(xmthlModiDummy);
        }
		if( this.status == 200) {
			ModiListe = JSON.parse(this.responseText);
		}
      var option;
      for (i = 0; i < ModiListe.Liste.length; i++) {
        option = document.createElement("option");
        option.text = ModiListe.Liste[i].Modus;
        Modus.add(option);
      } 
	}
    Modus.value = ModiListe.Modus;
    lade_Params();
}
function lade_Modus() {
  xhttpModi.open("GET", "/ModiListe", true);
  xhttpModi.send();
}

var xmthlParamDummy = '{"Modus":"Weiss","Params":[{"Name":"Farbe","Typ":"color","Wert":"#abcded"}]}';
var xhttpParams = new XMLHttpRequest();
  xhttpParams.onreadystatechange = function() {
	var ParamListe;
    if (this.readyState == 4) {
		if( this.status == 404) {
			ParamListe = JSON.parse(xmthlParamDummy);
        }
		if( this.status == 200) {
			ParamListe = JSON.parse(this.responseText);
		}
		try {
			var Kid;
			var NextKid;
			while(true) {
				Kid = Inputs.firstChild;
				Inputs.removeChild(Kid);
				Kid.remove();
			}
		}
		catch  {}
	
      for (i = 0; i < ParamListe.Params.length; i++) {
	      var input;
        input = document.createElement("input");
		input.name = ParamListe.Params[i].Name;
        input.type = ParamListe.Params[i].Typ;
        input.value = ParamListe.Params[i].Wert;
        input.min = ParamListe.Params[i].Min;
        input.max = ParamListe.Params[i].Max;
        input.value = ParamListe.Params[i].Wert;
        var para = document.createElement("p");
		var node = document.createTextNode(ParamListe.Params[i].Name);
		para.appendChild(node);
        para.appendChild(input);
        Inputs.appendChild(para);
      } 
	}
}
function lade_Params() {
  xhttpParams.open("GET", "/ParamListe?Modus="+Modus.value, true);
  xhttpParams.send();
}
</script>
</body>
</html>
